var a=50,b=1,c='#333',d=3,e=0x20,f=1000/30,g=1/20,h=0.9,l=[];let A;let j;let k=0;function m(){A=document.getElementById('spike-field');j=A.getContext('2d');p();addEventListener('resize',n);requestAnimationFrame(r);setInterval(u,f)}function n(){o();p()}function o(){for(const _ of l)_.dispose();l.length=0;j.reset()}function p(){A.width=document.body.clientWidth;A.height=document.body.clientHeight;q();var B=Math.max(d,A.width/a/4),C=1/B;for(let i=0;i<B;i++){var _c=(Math.random()*0.5+1.25)*Math.PI,D=3+Math.round(Math.random()*2),E=C*(i+Math.random()),F=document.body.clientHeight/a/4.5;var G=new Spike(_c, D, F);G.x=A.width*E/a;G.y=A.height/a;l.push(G)}}function q(){j.fillStyle=c;j.fillRect(0,A.height-a,A.width,a)}function r(_a){var _b=_a-k,_C=_b/1000*b;for(const _A of l)_A.advance(_C);k=_a;requestAnimationFrame(r)}class Spike{constructor(aA,_B,aB){this.branches=[];this.x=0;this.y=0;this.angle=aA;this.depth=_B;this.maxSize=aB;this.size=0}advance(aC){this.size!==this.maxSize&&(this.size=Math.min(this.size+aC,this.maxSize),this.maybeBranch(aC),this.draw());for(const aD of this.branches)aD.advance(aC)}maybeBranch(aE){if(h>this.size/this.maxSize&&this.depth>0&&Math.random()<aE){var aF=Math.random()>0.5?1:-1,aG=aF*(Math.random()*0.25+0.25)*Math.PI,_d=this.angle+aG,_e=this.maxSize-this.size/2,_f=_e*(0.33+Math.random()*0.33),_g=this.depth-1,H=this.size,J=this.getCoordinatesAtSize(H);var I=new Spike(_d, _g, _f);I.x=J.x;I.y=J.y;this.branches.push(I)}}draw(){var aH=this.getCoordinatesAtSize(this.size),aI=this.getBaseOffset();j.beginPath();j.moveTo(aH.x*a,aH.y*a);j.lineTo((this.x+aI.x)*a,(this.y+aI.y)*a);j.lineTo((this.x-aI.x)*a,(this.y-aI.y)*a);j.fillStyle=c;j.fill()}getCoordinatesAtSize(aJ){var aK=aJ*this.maxSize,x=this.x+Math.cos(this.angle)*aK,y=this.y+Math.sin(this.angle)*aK;return{x:x,y:y}}getBaseOffset(){var aL=this.size*this.maxSize*g,aM=this.angle+Math.PI/4,x=Math.cos(aM)*aL,y=Math.sin(aM)*aL;return{x:x,y:y}}getTotalCount(){return 1+this.branches.map(aN=>aN.getTotalCount()).reduce(t,0)}dispose(){for(const aO of this.branches)aO.dispose();this.branches=[]}}function t(aP,aQ){return aP+aQ}function u(){let aR=~~Math.random()*e.toString(16);aR.length==1&&(aR=`0${aR}`);document.body.style.backgroundColor=`${aR}0000`}addEventListener('load',m);
